# üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥—É–ª–µ –§–ù–°

## üìã **–û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –§–ù–°:**

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ SOAP –∑–∞–ø—Ä–æ—Å–æ–≤**
- ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `GetMessageRequest` —Å `AuthRequest`
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ–∫–æ–≤**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `SendMessageRequest` —Å `GetTicketRequest`
- ‚úÖ **–ó–∞–≥–æ–ª–æ–≤–∫–∏**: –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ `FNS-OpenApi-Token` –∏ `FNS-OpenApi-UserToken`

### 2. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- ‚úÖ **Rate Limiting (429)**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤
- ‚úÖ **MessageNotFoundFault**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ **AuthenticationFault**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏**: –õ–æ–≥–∏–∫–∞ retry –¥–ª—è rate limiting

### 3. **–£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ—á–µ—Ä–µ–¥–∏**
- ‚úÖ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤**: –ú–∞–∫—Å–∏–º—É–º 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ —Ä–∞–∑ (–≤–º–µ—Å—Ç–æ 10)
- ‚úÖ **–ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏**: 5 –º–∏–Ω—É—Ç –º–µ–∂–¥—É –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏
- ‚úÖ **–°—Ç–∞—Ç—É—Å—ã**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ `pending`/`rejected` –¥–ª—è rate limiting

### 4. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –§–ù–°**
- ‚úÖ **–°—Ç–∞—Ç—É—Å—ã**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ `PROCESSING` –∏ `COMPLETED`
- ‚úÖ **XML –ø–∞—Ä—Å–∏–Ω–≥**: –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç –§–ù–°
- ‚úÖ **–¢–∞–π–º–∞—É—Ç—ã**: –£–≤–µ–ª–∏—á–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

## üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**

### **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤:**
```xml
<!-- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è -->
<soapenv:Envelope>
  <soapenv:Body>
    <ns:GetMessageRequest>
      <ns:Message>
        <tns:AuthRequest>
          <tns:AuthAppInfo>
            <tns:MasterToken>TOKEN</tns:MasterToken>
          </tns:AuthAppInfo>
        </tns:AuthRequest>
      </ns:Message>
    </ns:GetMessageRequest>
  </soapenv:Body>
</soapenv:Envelope>

<!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ–∫–∞ -->
<soap-env:Envelope>
  <soap-env:Body>
    <ns0:SendMessageRequest>
      <ns0:Message>
        <tns:GetTicketRequest>
          <tns:GetTicketInfo>
            <tns:Sum>2400</tns:Sum>
            <tns:Date>2019-04-09T16:38:00</tns:Date>
            <tns:Fn>9287440300090728</tns:Fn>
            <tns:TypeOperation>1</tns:TypeOperation>
            <tns:FiscalDocumentId>77133</tns:FiscalDocumentId>
            <tns:FiscalSign>1482926127</tns:FiscalSign>
            <tns:RawData>true</tns:RawData>
          </tns:GetTicketInfo>
        </tns:GetTicketRequest>
      </ns0:Message>
    </ns0:SendMessageRequest>
  </soap-env:Body>
</soap-env:Envelope>
```

### **–ó–∞–≥–æ–ª–æ–≤–∫–∏ HTTP:**
```
Content-Type: text/xml;charset=UTF-8
SOAPAction: urn:SendMessageRequest
FNS-OpenApi-Token: TEMP_TOKEN
FNS-OpenApi-UserToken: UserToken1
```

### **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- **429 Rate Limiting**: –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
- **MessageNotFoundFault**: –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–∫–∞–∑
- **AuthenticationFault**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- **HTTP 500**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞

## üöÄ **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:**

### ‚úÖ **–ß—Ç–æ –≥–æ—Ç–æ–≤–æ:**
1. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** —Å –§–ù–°
2. **–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤** –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ–∫–æ–≤
3. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–∞—Ä—Å–∏–Ω–≥–æ–º
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
5. **–û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á** —Å –ª–∏–º–∏—Ç–∞–º–∏
6. **API endpoints** –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

### üîÑ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –§–ù–°
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è** (.env —Ñ–∞–π–ª)
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** —Ä–∞–±–æ—Ç—ã –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

## üìä **–õ–∏–º–∏—Ç—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

- **–î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç**: 1000 –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ó–∞–ø—Ä–æ—Å—ã –∑–∞ —Ä–∞–∑**: 5 (–≤–º–µ—Å—Ç–æ 10)
- **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏**: 3 —Ä–∞–∑–∞
- **–ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏**: 5 –º–∏–Ω—É—Ç
- **–¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–æ–≤**: 30 —Å–µ–∫—É–Ω–¥

## üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

–ú–æ–¥—É–ª—å –§–ù–° —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –§–ù–° –∏ –≥–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º API! 