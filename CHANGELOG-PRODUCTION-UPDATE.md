# üîÑ Changelog: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞

## üìÖ –î–∞—Ç–∞: 2024-08-07

### üéØ –¶–µ–ª—å –∏–∑–º–µ–Ω–µ–Ω–∏–π
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö FNS —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–æ–º `91.236.198.205:4020` –≤–º–µ—Å—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ `localhost:4020`.

## üìã –°–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### üîß –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤
1. **`tests/fns-scan-qr.test.js`**
   - –û–±–Ω–æ–≤–ª–µ–Ω `baseUrl` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `PROD_SERVER_IP` –∏ `PORT`
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω `JWT_SECRET` –∏–∑ –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

2. **`tests/fns-verify.test.js`**
   - –û–±–Ω–æ–≤–ª–µ–Ω `baseUrl` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞
   - –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

3. **`tests/fns-status.test.js`**
   - –û–±–Ω–æ–≤–ª–µ–Ω `baseUrl` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `PROD_SERVER_IP`

4. **`tests/fns-queue-stats.test.js`**
   - –ü–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

5. **`tests/fns-daily-count.test.js`**
   - –ò–∑–º–µ–Ω–µ–Ω URL –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä
   - –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### üìö –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
6. **`tests/run-all-new-fns-tests.js`**
   - –û–±–Ω–æ–≤–ª–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–π URL –≤ –ª–æ–≥–∞—Ö
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
   - –†–∞—Å—à–∏—Ä–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º –æ–∫—Ä—É–∂–µ–Ω–∏—è

7. **`tests/README-FNS-TESTS.md`**
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –ø—Ä–∏–º–µ—Ä—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º

### üÜï –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã
8. **`tests/.env.test`** (–Ω–æ–≤—ã–π)
   - –§–∞–π–ª —Å –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –í–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

9. **`tests/run-tests-production.sh`** (–Ω–æ–≤—ã–π)
   - –£–¥–æ–±–Ω—ã–π shell —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞

10. **`tests/PRODUCTION-TESTING-GUIDE.md`** (–Ω–æ–≤—ã–π)
    - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ
    - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
    - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ù–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –°—Ç–∞—Ä–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ª–æ–∫–∞–ª—å–Ω–∞—è)
BACKEND_URL=http://localhost:4020

# –ù–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ø—Ä–æ–¥–∞–∫—à–Ω)
PROD_SERVER_IP=91.236.198.205
PORT=4020
BACKEND_URL=http://91.236.198.205:4020  # –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
PORT=4020
DATABASE_URL=postgresql://pharm_vision:pharm_vision_password@localhost:5432/pharm_vision_db_test?schema=public
ROOT_ADMIN_USERNAME=admin
ROOT_ADMIN_PASSWORD=admin
JWT_SECRET=gpW7DtMraBcCf4rXXyMmLZ25cMsrjv6z
SALT=10
YANDEX_ADDRESS=Anashkin.met@yandex.ru
YANDEX_PASS=knlqilweektnzxub
FRONTEND_URL=https://pharm-vision.vercel.app/
FTX_API_URL=https://openapi.nalog.ru:8090
FTX_TOKEN=LFgDIA4yBZjW6h174iwVDcRoDHhjmpuFLtAX3kHPT9ctgggajk36aLJIzIcs2kZyKvTqLy4rSEHi7KOgY0fuNHKPbGCekDg9qjpin04K4ZyfolqtwDBZ6f6Isja3MMWe
PROD_SERVER_IP=91.236.198.205
```

## üöÄ –°–ø–æ—Å–æ–±—ã –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ shell —Å–∫—Ä–∏–ø—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
cd tests
./run-tests-production.sh              # –í—Å–µ —Ç–µ—Å—Ç—ã
./run-tests-production.sh scanQr      # –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç
```

### 2. –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
```bash
export PROD_SERVER_IP=91.236.198.205
export PORT=4020
export JWT_SECRET=gpW7DtMraBcCf4rXXyMmLZ25cMsrjv6z
# ... –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
node run-all-new-fns-tests.js
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞
```bash
cp .env.test .env
node run-all-new-fns-tests.js
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- ‚úÖ 5 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ 3 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞ —Å–æ–∑–¥–∞–Ω—ã  
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ Shell —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø—Ä–∞–≤–∫–∏ (—Ä–∞–±–æ—Ç–∞–µ—Ç)
cd tests && ./run-tests-production.sh help

# –í—ã–≤–æ–¥:
# üöÄ –ó–∞–ø—É—Å–∫ FNS —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ
# üìç –°–µ—Ä–≤–µ—Ä: 91.236.198.205:4020
# üåê Backend URL: http://91.236.198.205:4020
# ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –¢–µ—Å—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ `localhost:4020`
- –ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–æ–º
- –ù–µ—Ç —É–¥–æ–±–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –∑–∞–ø—É—Å–∫–∞

### –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π  
- –¢–µ—Å—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ `91.236.198.205:4020`
- –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–¥–∞–∫—à–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- 3 —Å–ø–æ—Å–æ–±–∞ —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

## üîÆ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞** –≤ shell —Å–∫—Ä–∏–ø—Ç–µ
2. **–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –æ—à–∏–±–æ–∫
3. **CI/CD –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å** —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –¥–ª—è GitHub Actions
4. **–ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å**: üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ